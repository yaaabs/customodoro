<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FocusKaya Timer</title>
  <style>
    :root {
      --focus-color: #d95550;
      --short-break-color: #4c9195;
      --long-break-color: #457ca3;
      --bg-light: #f5f5f5;
      --text-dark: #333333;
      --text-light: #ffffff;
      --shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Roboto', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      background-color: var(--bg-light);
      transition: var(--transition);
    }
    
    body.focus-mode {
      background-color: var(--focus-color);
    }
    
    body.short-break-mode {
      background-color: var(--short-break-color);
    }
    
    body.long-break-mode {
      background-color: var(--long-break-color);
    }
    
    .container {
      width: 100%;
      max-width: 600px;
      margin: 20px auto;
    }
    
    header {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .app-title {
      font-size: 32px;
      color: var(--text-light);
      font-weight: 700;
      margin-bottom: 10px;
    }
    
    .mode-tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 20px;
      border-radius: 8px;
      overflow: hidden;
      background-color: rgba(0, 0, 0, 0.1);
    }
    
    .tab {
      padding: 12px 0;
      flex: 1;
      text-align: center;
      cursor: pointer;
      color: var(--text-light);
      font-weight: 600;
      transition: var(--transition);
      opacity: 0.7;
    }
    
    .tab.active {
      opacity: 1;
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .timer-container {
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      padding: 30px;
      text-align: center;
      box-shadow: var(--shadow);
      margin-bottom: 30px;
    }
    
    .timer {
      font-size: 100px;
      font-weight: bold;
      color: var(--text-light);
      margin: 20px 0;
      line-height: 1;
    }
    
    @media (max-width: 600px) {
      .timer {
        font-size: 72px;
      }
    }
    
    @media (max-width: 400px) {
      .timer {
        font-size: 60px;
      }
    }
    
    .timer-actions {
      display: flex;
      justify-content: center;
      margin-top: 30px;
    }
    
    .primary-btn {
      padding: 16px 50px;
      border: none;
      border-radius: 8px;
      font-size: 22px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      background-color: var(--text-light);
      color: var(--text-dark);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .primary-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }
    
    .primary-btn:active {
      transform: translateY(0);
    }
    
    .secondary-btn {
      background: none;
      border: none;
      color: var(--text-light);
      font-size: 16px;
      cursor: pointer;
      padding: 10px 15px;
      margin-left: 15px;
      border-radius: 6px;
      opacity: 0.7;
      transition: var(--transition);
    }
    
    .secondary-btn:hover {
      opacity: 1;
      background-color: rgba(255, 255, 255, 0.1);
    }
    
    .progress-container {
      height: 4px;
      background-color: rgba(0, 0, 0, 0.1);
      border-radius: 2px;
      margin-top: 30px;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      background-color: rgba(255, 255, 255, 0.7);
      width: 0%;
      transition: width 1s linear;
    }
    
    .session-info {
      color: var(--text-light);
      margin-top: 15px;
      font-size: 16px;
      opacity: 0.9;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .session-count {
      display: flex;
      gap: 5px;
    }
    
    .session-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.3);
      display: inline-block;
    }
    
    .session-dot.completed {
      background-color: rgba(255, 255, 255, 0.9);
    }
    
    .settings-section {
      background-color: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: var(--shadow);
    }
    
    .settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }
    
    .settings-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-dark);
    }
    
    .settings-toggle {
      background: none;
      border: none;
      color: #777;
      cursor: pointer;
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    
    .settings-content {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.5s ease;
    }
    
    .settings-content.open {
      max-height: 500px;
    }
    
    .setting-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      border-bottom: 1px solid #eee;
    }
    
    .setting-row:last-child {
      border-bottom: none;
    }
    
    .setting-label {
      color: var(--text-dark);
      font-weight: 500;
    }
    
    .time-controls {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .time-value {
      width: 50px;
      text-align: center;
      font-size: 18px;
      font-weight: 600;
      color: var(--text-dark);
    }
    
    .time-btn {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      border: 1px solid #ddd;
      background-color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: var(--transition);
      color: #555;
      font-weight: bold;
    }
    
    .time-btn:hover {
      background-color: #f5f5f5;
    }
    
    .footer {
      margin-top: 30px;
      text-align: center;
      color: var(--text-light);
      opacity: 0.7;
      font-size: 14px;
    }
    
    /* Toast notification */
    .toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 16px;
      z-index: 1000;
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
    }
    
    .toast.show {
      opacity: 1;
    }
    
    /* Tasks section */
    .tasks-section {
      background-color: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: var(--shadow);
      margin-top: 30px;
    }
    
    .tasks-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .tasks-title {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-dark);
    }
    
    .task-input-container {
      display: flex;
      margin-bottom: 20px;
    }
    
    .task-input {
      flex: 1;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 8px 0 0 8px;
      font-size: 16px;
    }
    
    .add-task-btn {
      padding: 12px 20px;
      background-color: var(--focus-color);
      color: white;
      border: none;
      border-radius: 0 8px 8px 0;
      cursor: pointer;
      font-weight: 600;
    }
    
    .task-list {
      list-style: none;
    }
    
    .task-item {
      display: flex;
      align-items: center;
      padding: 12px 0;
      border-bottom: 1px solid #eee;
    }
    
    .task-checkbox {
      margin-right: 15px;
      width: 20px;
      height: 20px;
      cursor: pointer;
    }
    
    .task-text {
      flex: 1;
      font-size: 16px;
      color: var(--text-dark);
    }
    
    .task-completed .task-text {
      text-decoration: line-through;
      color: #999;
    }
    
    .task-delete {
      background: none;
      border: none;
      color: #999;
      cursor: pointer;
      font-size: 16px;
      opacity: 0.5;
      transition: opacity 0.2s;
    }
    
    .task-delete:hover {
      opacity: 1;
      color: #d95550;
    }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .container {
        padding: 0 15px;
      }
      
      .timer-container {
        padding: 20px;
      }
      
      .primary-btn {
        padding: 12px 30px;
        font-size: 18px;
      }
    }
  </style>
</head>
<body class="focus-mode">
  <div class="container">
    <header>
      <h1 class="app-title">FocusKaya Timer</h1>
      <div class="mode-tabs">
        <div class="tab active" id="pomodoro-tab">Pomodoro</div>
        <div class="tab" id="short-break-tab">Short Break</div>
        <div class="tab" id="long-break-tab">Long Break</div>
      </div>
    </header>
    
    <div class="timer-container">
      <div class="timer" id="timer">25:00</div>
      <div class="timer-actions">
        <button class="primary-btn" id="start-btn">START</button>
        <button class="secondary-btn" id="reset-btn">Reset</button>
      </div>
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      <div class="session-info">
        <div class="session-count" id="session-dots">
          <span class="session-dot"></span>
          <span class="session-dot"></span>
          <span class="session-dot"></span>
          <span class="session-dot"></span>
        </div>
        <div class="session-text" id="session-text">#1</div>
      </div>
    </div>
    
    <div class="settings-section">
      <div class="settings-header">
        <div class="settings-title">Settings</div>
        <button class="settings-toggle" id="settings-toggle">
          <span>Show</span> ▼
        </button>
      </div>
      <div class="settings-content" id="settings-content">
        <div class="setting-row">
          <div class="setting-label">Pomodoro Length</div>
          <div class="time-controls">
            <button class="time-btn" id="pomodoro-minus">-</button>
            <div class="time-value" id="pomodoro-value">25</div>
            <button class="time-btn" id="pomodoro-plus">+</button>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-label">Short Break Length</div>
          <div class="time-controls">
            <button class="time-btn" id="short-minus">-</button>
            <div class="time-value" id="short-value">5</div>
            <button class="time-btn" id="short-plus">+</button>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-label">Long Break Length</div>
          <div class="time-controls">
            <button class="time-btn" id="long-minus">-</button>
            <div class="time-value" id="long-value">15</div>
            <button class="time-btn" id="long-plus">+</button>
          </div>
        </div>
        <div class="setting-row">
          <div class="setting-label">Sessions until Long Break</div>
          <div class="time-controls">
            <button class="time-btn" id="sessions-minus">-</button>
            <div class="time-value" id="sessions-value">4</div>
            <button class="time-btn" id="sessions-plus">+</button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="tasks-section">
      <div class="tasks-header">
        <div class="tasks-title">Tasks</div>
      </div>
      <div class="task-input-container">
        <input type="text" class="task-input" id="task-input" placeholder="What are you working on?">
        <button class="add-task-btn" id="add-task-btn">Add</button>
      </div>
      <ul class="task-list" id="task-list">
        <!-- Tasks will be added here -->
      </ul>
    </div>
    
    <div class="footer">
      © 2025 FocusKaya Timer - All Rights Reserved
    </div>
  </div>
  
  <div class="toast" id="toast"></div>

  <script>
    // DOM Elements
    const timerElement = document.getElementById('timer');
    const progressBar = document.getElementById('progress-bar');
    const startButton = document.getElementById('start-btn');
    const resetButton = document.getElementById('reset-btn');
    const sessionDots = document.getElementById('session-dots');
    const sessionText = document.getElementById('session-text');
    const body = document.body;
    
    // Tab elements
    const pomodoroTab = document.getElementById('pomodoro-tab');
    const shortBreakTab = document.getElementById('short-break-tab');
    const longBreakTab = document.getElementById('long-break-tab');
    
    // Settings elements
    const settingsToggle = document.getElementById('settings-toggle');
    const settingsContent = document.getElementById('settings-content');
    
    // Task elements
    const taskInput = document.getElementById('task-input');
    const addTaskBtn = document.getElementById('add-task-btn');
    const taskList = document.getElementById('task-list');
    
    // Time setting elements
    const pomodoroValue = document.getElementById('pomodoro-value');
    const shortValue = document.getElementById('short-value');
    const longValue = document.getElementById('long-value');
    const sessionsValue = document.getElementById('sessions-value');
    
    // Time setting buttons
    const pomodoroMinus = document.getElementById('pomodoro-minus');
    const pomodoroPlus = document.getElementById('pomodoro-plus');
    const shortMinus = document.getElementById('short-minus');
    const shortPlus = document.getElementById('short-plus');
    const longMinus = document.getElementById('long-minus');
    const longPlus = document.getElementById('long-plus');
    const sessionsMinus = document.getElementById('sessions-minus');
    const sessionsPlus = document.getElementById('sessions-plus');
    
    // Toast notification
    const toast = document.getElementById('toast');
    
    // Timer variables
    let pomodoroTime = 25;
    let shortBreakTime = 5;
    let longBreakTime = 15;
    let maxSessions = 4;
    let currentMode = 'pomodoro';
    let currentSeconds = pomodoroTime * 60;
    let initialSeconds = currentSeconds;
    let timerInterval = null;
    let isRunning = false;
    let currentSession = 1;
    let completedPomodoros = 0;
    
    // Initialize the timer display
    updateTimerDisplay();
    updateSessionDots();
    
    // Initialize event listeners
    startButton.addEventListener('click', toggleTimer);
    resetButton.addEventListener('click', resetTimer);
    
    // Tab event listeners
    pomodoroTab.addEventListener('click', () => switchMode('pomodoro'));
    shortBreakTab.addEventListener('click', () => switchMode('shortBreak'));
    longBreakTab.addEventListener('click', () => switchMode('longBreak'));
    
    // Settings toggle
    settingsToggle.addEventListener('click', toggleSettings);
    
    // Time setting event listeners
    pomodoroMinus.addEventListener('click', () => updateTimeValue('pomodoro', -1));
    pomodoroPlus.addEventListener('click', () => updateTimeValue('pomodoro', 1));
    shortMinus.addEventListener('click', () => updateTimeValue('shortBreak', -1));
    shortPlus.addEventListener('click', () => updateTimeValue('shortBreak', 1));
    longMinus.addEventListener('click', () => updateTimeValue('longBreak', -1));
    longPlus.addEventListener('click', () => updateTimeValue('longBreak', 1));
    sessionsMinus.addEventListener('click', () => updateTimeValue('sessions', -1));
    sessionsPlus.addEventListener('click', () => updateTimeValue('sessions', 1));
    
    // Task event listeners
    addTaskBtn.addEventListener('click', addTask);
    taskInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') addTask();
    });
    
    // Update timer display
    function updateTimerDisplay() {
      const minutes = Math.floor(currentSeconds / 60);
      const seconds = currentSeconds % 60;
      timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
      
      document.title = `${timerElement.textContent} - FocusKaya Timer`;
      
      // Update progress bar
      if (initialSeconds > 0) {
        const progress = ((initialSeconds - currentSeconds) / initialSeconds) * 100;
        progressBar.style.width = `${progress}%`;
      }
    }
    
    // Toggle timer between start and pause
    function toggleTimer() {
      if (!isRunning) {
        // Start timer
        isRunning = true;
        startButton.textContent = 'PAUSE';
        
        timerInterval = setInterval(() => {
          if (currentSeconds > 0) {
            currentSeconds--;
            updateTimerDisplay();
          } else {
            // Timer completed
            clearInterval(timerInterval);
            playNotification();
            showToast(getCompletionMessage());
            
            // Move to next timer phase
            if (currentMode === 'pomodoro') {
              completedPomodoros++;
              if (completedPomodoros % maxSessions === 0) {
                switchMode('longBreak');
              } else {
                switchMode('shortBreak');
              }
            } else {
              // After a break, go back to pomodoro
              if (currentMode === 'longBreak') {
                currentSession = 1;
              } else {
                currentSession++;
              }
              switchMode('pomodoro');
            }
            
            updateSessionDots();
            startButton.textContent = 'START';
            isRunning = false;
          }
        }, 1000);
      } else {
        // Pause timer
        clearInterval(timerInterval);
        isRunning = false;
        startButton.textContent = 'START';
      }
    }
    
    // Reset the current timer
    function resetTimer() {
      clearInterval(timerInterval);
      
      // Reset to initial time based on current mode
      if (currentMode === 'pomodoro') {
        currentSeconds = pomodoroTime * 60;
      } else if (currentMode === 'shortBreak') {
        currentSeconds = shortBreakTime * 60;
      } else {
        currentSeconds = longBreakTime * 60;
      }
      
      initialSeconds = currentSeconds;
      isRunning = false;
      startButton.textContent = 'START';
      updateTimerDisplay();
      progressBar.style.width = '0%';
    }
    
    // Switch between pomodoro, short break, and long break modes
    function switchMode(mode) {
      currentMode = mode;
      
      // Reset active tab styles
      pomodoroTab.classList.remove('active');
      shortBreakTab.classList.remove('active');
      longBreakTab.classList.remove('active');
      
      // Set up the new mode
      if (mode === 'pomodoro') {
        currentSeconds = pomodoroTime * 60;
        body.className = 'focus-mode';
        pomodoroTab.classList.add('active');
      } else if (mode === 'shortBreak') {
        currentSeconds = shortBreakTime * 60;
        body.className = 'short-break-mode';
        shortBreakTab.classList.add('active');
      } else {
        currentSeconds = longBreakTime * 60;
        body.className = 'long-break-mode';
        longBreakTab.classList.add('active');
      }
      
      initialSeconds = currentSeconds;
      
      // Reset timer if it was running
      if (isRunning) {
        clearInterval(timerInterval);
        isRunning = false;
        startButton.textContent = 'START';
      }
      
      updateTimerDisplay();
      progressBar.style.width = '0%';
    }
    
    // Update session dots display
    function updateSessionDots() {
      // Clear all dots
      while (sessionDots.firstChild) {
        sessionDots.removeChild(sessionDots.firstChild);
      }
      
      // Add dots based on maxSessions
      for (let i = 0; i < maxSessions; i++) {
        const dot = document.createElement('span');
        dot.className = 'session-dot';
        if (i < completedPomodoros % maxSessions) {
          dot.classList.add('completed');
        }
        sessionDots.appendChild(dot);
      }
      
      sessionText.textContent = `#${currentSession}`;
    }
    
    // Toggle settings panel
    function toggleSettings() {
      settingsContent.classList.toggle('open');
      const isOpen = settingsContent.classList.contains('open');
      settingsToggle.querySelector('span').textContent = isOpen ? 'Hide' : 'Show';
    }
    
    // Update time values (pomodoro, short break, long break, sessions)
    function updateTimeValue(type, change) {
      let currentValue, minValue = 1, maxValue = 60;
      
      if (type === 'pomodoro') {
        currentValue = pomodoroTime;
        pomodoroTime = Math.max(minValue, Math.min(maxValue, currentValue + change));
        pomodoroValue.textContent = pomodoroTime;
        
        if (currentMode === 'pomodoro') {
          resetTimer();
        }
      } else if (type === 'shortBreak') {
        currentValue = shortBreakTime;
        shortBreakTime = Math.max(minValue, Math.min(maxValue, currentValue + change));
        shortValue.textContent = shortBreakTime;
        
        if (currentMode === 'shortBreak') {
          resetTimer();
        }
      } else if (type === 'longBreak') {
        currentValue = longBreakTime;
        longBreakTime = Math.max(minValue, Math.min(maxValue, currentValue + change));
        longValue.textContent = longBreakTime;
        
        if (currentMode === 'longBreak') {
          resetTimer();
        }
      } else if (type === 'sessions') {
        minValue = 1;
        maxValue = 12;
        currentValue = maxSessions;
        maxSessions = Math.max(minValue, Math.min(maxValue, currentValue + change));
        sessionsValue.textContent = maxSessions;
        
        // Update session dots
        updateSessionDots();
      }
    }
    
    // Play notification sound
    function playNotification() {
      try {
        // Create audio context
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        
        // Create oscillator
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        
        oscillator.type = 'sine';
        oscillator.frequency.value = 800;
        gainNode.gain.value = 0.5;
        
        oscillator.start();
        
        // Fade out
        gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 1);
        
        // Stop after 1 second
        setTimeout(() => {
          oscillator.stop();
        }, 1000);
      } catch (e) {
        console.log('Audio not supported');
      }
      
      // Desktop notification
      if ('Notification' in window && Notification.permission === 'granted') {
        let title, body;
        
        if (currentMode === 'pomodoro') {
          title = 'Break Time!';
          body = 'Great job! Time to take a break.';
        } else {
          title = 'Focus Time!';
          body = 'Break is over. Time to focus!';
        }
        
        new Notification(title, {
          body: body,
          icon: '/api/placeholder/192/192'
        });
      } else if ('Notification' in window && Notification.permission !== 'denied') {
        Notification.requestPermission();
      }
    }
    
    // Get timer completion message
    function getCompletionMessage() {
      if (currentMode === 'pomodoro') {
        return 'Time for a break!';
      } else if (currentMode === 'shortBreak') {
        return 'Break finished! Time to focus.';
      } else {
        return 'Long break finished! Ready for a new session?';
      }
    }
    
    // Show toast notification
    function showToast(message) {
      toast.textContent = message;
      toast.classList.add('show');
      
      setTimeout(() => {
        toast.classList.remove('show');
      }, 3000);
    }
    
    // Add task to task list
    function addTask() {
      const taskText = taskInput.value.trim();
      
      if (taskText !== '') {
        // Create task item
        const taskItem = document.createElement('li');
        taskItem.className = 'task-item';
        
        // Create checkbox
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.className = 'task-checkbox';
        checkbox.addEventListener('change', () => {
          taskItem.classList.toggle('task-completed', checkbox.checked);
        });
        
        // Create task text
        const text = document.createElement('span');
        text.className = 'task-text';
        text.textContent = taskText;
        
        // Create delete button
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'task-delete';
        deleteBtn.textContent = '×';
        deleteBtn.addEventListener('click', () => {
          taskList.removeChild(taskItem);
        });
        
        // Append elements to task item
        taskItem.appendChild(checkbox);
        taskItem.appendChild(text);
        taskItem.appendChild(deleteBtn);
        
        // Add task to list
        taskList.appendChild(taskItem);
        
        // Clear input
        taskInput.value = '';
      }
    }
    
    // Request notification permission
    if ('Notification' in window) {
      Notification.requestPermission();
    }
  </script>
</body>
</html>